[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ 
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ printf "${BOLD}${CYAN}ATS è‡ªæ£€&ä¿®å¤ å¼€å§‹ï¼š%s (UTC)${RESET}\n" "$(date -u '+%F %T')"
[?2004l[1m[36mATS è‡ªæ£€&ä¿®å¤ å¼€å§‹ï¼š2025-10-17 17:25:26 (UTC)[0m
[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ echo "APP_DIR=$APP_DIR"
[?2004lAPP_DIR=/opt/ats-quant
[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ echo "ENV_FILE=$ENV_FILE"
[?2004lENV_FILE=/opt/ats-quant/.env
[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ 
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ # 0) è¯»å– .envï¼ˆç”¨äº Telegram å‘é€ï¼‰
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ if read_env; then
[?2004l[?2004h>   ok ".env è¯»å–æˆåŠŸï¼ˆè„±æ•ï¼‰"
[?2004l[?2004h>   [[ -n "${TELEGRAM_BOT_TOKEN:-}"      ]] && ok "TELEGRAM_BOT_TOKEN: $(mask "$TELEGRAM_BOT_TOKEN")" || warn "æœªé…ç½® TELEGRAM_BOT_TOKEN"
[?2004l[?2004h>   [[ -n "${TELEGRAM_CHAT_ID_PRIMARY:-}" ]] && ok "TELEGRAM_CHAT_ID_PRIMARY: ${TELEGRAM_CHAT_ID_PRIMARY}" || warn "æœªé…ç½® TELEGRAM_CHAT_ID_PRIMARY"
[?2004l[?2004h> else
[?2004l[?2004h>   warn "æœªæ‰¾åˆ°æˆ–æ— æ³•è¯»å– .envï¼š$ENV_FILEï¼ˆç¨åä»ç»§ç»­ï¼‰"
[?2004l[?2004h> fi
[?2004l[32mâœ” PASS[0m  .env è¯»å–æˆåŠŸï¼ˆè„±æ•ï¼‰
[32mâœ” PASS[0m  TELEGRAM_BOT_TOKEN: 628015***QSSw
[32mâœ” PASS[0m  TELEGRAM_CHAT_ID_PRIMARY: -1001951843401
[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ 
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ tg_msg "ğŸ§ª ATS è‡ªæ£€&ä¿®å¤å¼€å§‹ ${TS} (UTC) | $(hostname)" >/dev/null 2>&1 || true
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ 
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ # 1) åŸºç¡€ç¯å¢ƒ & OpenSSL
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ ttl "1) åŸºç¡€å‘½ä»¤"
[?2004l
[1m[36m1) åŸºç¡€å‘½ä»¤[0m
[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ for c in git curl openssl; do
[?2004l[?2004h>   if have "$c"; then ok "å­˜åœ¨å‘½ä»¤ï¼š$c"; else
[?2004l[?2004h>     warn "ç¼ºå°‘ $cï¼Œå°è¯•å®‰è£…â€¦"
[?2004l[?2004h>     sudo apt update -y >/dev/null 2>&1 || true
[?2004l[?2004h>     sudo apt install -y "$c" >/dev/null 2>&1 && ok "å·²å®‰è£… $c" || fail "å®‰è£… $c å¤±è´¥" [A
[?2004l[?2004h>   fi
[?2004l[?2004h> done
[?2004l[32mâœ” PASS[0m  å­˜åœ¨å‘½ä»¤ï¼šgit
[32mâœ” PASS[0m  å­˜åœ¨å‘½ä»¤ï¼šcurl
[32mâœ” PASS[0m  å­˜åœ¨å‘½ä»¤ï¼šopenssl
[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ 
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ # 2) å®‰è£…/ä¿®å¤ Docker + Compose
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ ttl "2) Docker & Compose"
[?2004l
[1m[36m2) Docker & Compose[0m
[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ if have docker; then
[?2004l[?2004h>   ok "Docker å·²å®‰è£…ï¼š$(docker --version 2>/dev/null)"
[?2004l[?2004h> else
[?2004l[?2004h>   warn "æœªæ£€æµ‹åˆ° dockerï¼Œå¼€å§‹å®‰è£…ï¼ˆå®˜æ–¹æºï¼‰â€¦"
[?2004l[?2004h>   sudo apt install -y ca-certificates curl gnupg lsb-release >/dev/null 2>&1 || true
[?2004l[?2004h>   sudo install -m 0755 -d /etc/apt/keyrings || true
[?2004l[?2004h>   curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg >/dev/null 2>&1 || true
[?2004l[?2004h>   echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(. /etc/os-release && echo $VERSION_CODENAME) stable" \
[?2004l[?2004h>     | sudo tee /etc/apt/sources.list.d/docker.list >/dev/null
[?2004l[?2004h>   sudo apt update -y >/dev/null 2>&1 || true
[?2004l[?2004h>   if sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin >/dev/null 2>&1; then
[?2004l[?2004h>     ok "Docker CE ä¸ Compose æ’ä»¶å®‰è£…å®Œæˆ"
[?2004l[?2004h>   else
[?2004l[?2004h>     warn "å®˜æ–¹æºå¤±è´¥ï¼Œå›é€€å®‰è£… docker.io + docker-compose-pluginâ€¦"
[?2004l[?2004h>     sudo apt install -y docker.io docker-compose-plugin >/dev/null 2>&1 && ok "å·²å®‰è£… docker.io / compose-plugin" || fail "docker å®‰è£…å¤±è´¥"
[?2004l[?2004h>   fi
[?2004l[?2004h>   sudo systemctl enable --now docker >/dev/null 2>&1 || true
[?2004l[?2004h> fi
[?2004l[33mâš  WARN[0m  æœªæ£€æµ‹åˆ° dockerï¼Œå¼€å§‹å®‰è£…ï¼ˆå®˜æ–¹æºï¼‰â€¦
[32mâœ” PASS[0m  Docker CE ä¸ Compose æ’ä»¶å®‰è£…å®Œæˆ
[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [K]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [K]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [K]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ 
[?2004l[?2004h]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [K]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [K]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [K]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [K]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [K]0;linuxuser@bn-bot-sg: ~[01;32mlinuxuser@bn-bot-sg[00m:[01;34m~[00m$ [?2004l[?2004l
